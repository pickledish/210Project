<!-- <script src="/static/ceg.js"></script> -->

<style type="text/css">
	.review_sad {
		height: auto;
		padding: 10px;
		width: 90%;
		border: 2px solid grey;
		display: inline-block;
		margin-bottom: 20px;
		background-image: url({{ url_for('static', filename = 'sad.png') }}) ;
		background-size:65px 65px;
	}
	.review_excited {
		height: auto;
		padding: 10px;
		width: 90%;
		border: 2px solid grey;
		display: inline-block;
		margin-bottom: 20px;
		background-image:url({{ url_for('static', filename = 'excited.png') }});
		background-size:65px 65px;
	}
	.review_love {
		height: auto;
		padding: 10px;
		width: 90%;
		border: 2px solid grey;
		display: inline-block;
		margin-bottom: 20px;
		background-image:url({{ url_for('static', filename = 'love.png') }});
		background-size:65px 65px;
	}
	.review_happy {
		height: auto;
		padding: 10px;
		width: 90%;
		border: 2px solid grey;
		display: inline-block;
		margin-bottom: 20px;
		background-image:url({{ url_for('static', filename = 'happy.png') }});
		background-size:65px 65px;
	}
  /*.btn{
		font-size: 12px
		background-color: green
	}*/
	.info {
		text-align: left;
		color: grey;
		font-size: 9pt;
	}
</style>

{% for r in reviews %}
{% set m = review_moods[loop.index - 1] %}

{% if m == "sad" %}
	<div class="review_sad">
{% elif m == "excited" %}
	<div class="review_excited">
{% elif m == "love" %}
	<div class="review_love">
{% else %}
	<div class="review_happy">
{% endif %}

    <span class="info">User {{r.username_of_reactor}} posted on {{ r.time_created.strftime('%Y-%m-%d') }}: </span> <br/>

		<div commentTime="{{r.time_created}}"> {{r.reaction_text}} </div>

		{% if r.username_of_reactor == curuser %}
	</br><p><button class = "edit" class="btn" data-datetime = "{{r.time_created}}"> Edit </button> <button class = "delete" data-datetime = "{{r.time_created}}" class="btn"> Delete </button></p>
		{% endif %}
	</div>

{% endfor %}

<script>
$('.edit').on('click',function(event){
  event.preventDefault();
  var timeValue = event.target.attributes.getNamedItem('data-datetime').value;
  var jQuerySearch = "div[commentTime='".concat(timeValue, "']");
  var $commentDiv = $(jQuerySearch);
  var newHtml = "<textarea style=\"height: auto; width: auto;\" ".concat("currentTime=\"", timeValue, "\">", $commentDiv.text(), "</textarea>");
  $commentDiv.html(newHtml);

  var $editButton = $(".edit[data-datetime='".concat(timeValue, "']"));
  $editButton.text("Commit");
  $editButton.attr('class', 'commit');

  var $delButton = $(".delete[data-datetime='".concat(timeValue, "']"));
  $delButton.text("Cancel");
  $delButton.attr('class', 'cancel');

});

$('.cancel').on('click',function(event){
	event.preventDefault();
	var timeValue = event.target.attributes.getNamedItem('data-datetime').value;
});

$('.delete').on('click',function(event){
  event.preventDefault();
  var timeValue = event.target.attributes.getNamedItem('data-datetime').value;
  $.ajax({
    type: "POST",
    url: "/ajaxCEG/",
    data: {reactionTime: timeValue,
           sender: "delete"},
    dataType: "html",
    success: function(html){
      $("#reviewContainer").html(html);
    }
  });
});
</script>
